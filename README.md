# 黄金数据采集

## 项目概述

基于 Node.js 的黄金价格数据采集系统，可以获取并存储从当前时刻到过去一段时间内的黄金市场数据。

## 主要功能

- 数据存储为结构化 JSON 格式，可以把数据喂给 ai，让 ai 进行预测和分析
- 支持分钟/小时/日/周/月不同时间维度
- 提供基础数据 k 线图展示页面

## 安装步骤

```bash
npm install
```

## 使用方法

- 启动数据采集服务并启动 Web 服务

```bash
npm start
```

## 数据输出结构

数据存储在/outputs 目录下：

```
outputs/
├── 分钟K数据.json
├── 小时K数据.json
├── 日K数据.json
├── 周K数据.json
└── 月K数据.json
```

数据的结构结构如下：
| 名称 | 类型 | 必选 | 说明 |
|--------------|--------|------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ret | integer| true | |
| msg | string | true | |
| trace | string | true | |
| data | object | true | |
| » code | string | true | 代码 |
| » kline_type | integer| true | k 线类型<br>1、1 是 1 分钟 K，2 是 5 分钟 K，3 是 15 分钟 K，4 是 30 分钟 K，5 是小时 K，6 是 2 小时 K(股票不支持 2 小时)，7 是 4 小时 K(股票不支持 4 小时)，8 是日 K，9 是周 K，10 是月 K <br>2、最短的 k 线只支持 1 分钟 |
| » kline_list | [object] | true | |
| »» timestamp | string | true | 该 K 线时间戳 |
| »» open_price| string | true | 该 K 线开盘价 |
| »» close_price| string | true | 该 K 线收盘价 |
| »» high_price| string | true | 该 K 线最高价 |
| »» low_price | string | true | 该 K 线最低价 |
| »» volume | string | true | 该 K 线成交数量 |
| »» turnover | string | true | 该 K 线成交金额 |

## 配置文件

- 通过修改 .env 中的配置项来设置你的 API_TOKEN
- 由于有免费方案，所以我把我的个人免费 token 默认写上了，如果我的 token 不能用或过期了，请自己去申请一个
- [申请 token](https://alltick.co/register)

## 常见问题

- 为什么间隔 11 秒才采集一次数据？
  - 因为免费版的请求频率限制

| 计划          | 单独请求                    | 同时请求多个 HTTP 接口                                                                                                                                                                           |
| ------------- | --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **免费**      | 每 10 秒只能进行 1 次请求   | 同 1 秒只能请求 1 个；接口多个接口请求时，需注意/batch-kline 接口需间隔 10 秒；所有接口相加，1 分钟最大请求 10 次(6 秒 1 次)；每天总共最大可请求 14400 次，超过则第二天凌晨恢复使用              |
| **基础**      | 每 1 秒只能进行 1 次请求    | 同 1 秒只能请求 1 个；接口多个接口请求时，需注意/batch-kline 接口需间隔 3 秒；所有接口相加，1 分钟最大请求 60 次(1 秒 1 次)；每天总共最大可请求 86400 次，超过则第二天凌晨恢复使用               |
| **高级**      | 每 1 秒最多可进行 10 次请求 | 所有接口相加，每 1 秒可请求 10 次；多个接口请求时，需注意/batch-kline 接口需间隔 2 秒；所有接口相加，1 分钟最大请求 600 次(1 秒 10 次)；每天总共最大可请求 864000 次，超过则第二天凌晨恢复使用   |
| **专业**      | 每 1 秒最多可进行 20 次请求 | 所有接口相加，每 1 秒可请求 20 次；多个接口请求时，需注意/batch-kline 接口需间隔 1 秒；所有接口相加，1 分钟最大请求 1200 次(1 秒 20 次)；每天总共最大可请求 1728000 次，超过则第二天凌晨恢复使用 |
| **全部港股**  | 每 1 秒最多可进行 20 次请求 | 所有接口相加，每 1 秒可请求 20 次；多个接口请求时，需注意/batch-kline 接口需间隔 1 秒；所有接口相加，1 分钟最大请求 1200 次(1 秒 20 次)；每天总共最大可请求 1728000 次，超过则第二天凌晨恢复使用 |
| **全部 A 股** | 每 1 秒最多可进行 20 次请求 | 所有接口相加，每 1 秒可请求 20 次；多个接口请求时，需注意/batch-kline 接口需间隔 1 秒；所有接口相加，1 分钟最大请求 1200 次(1 秒 20 次)；每天总共最大可请求 1728000 次，超过则第二天凌晨恢复使用 |
| **全部美股**  | 每 1 秒最多可进行 20 次请求 | 所有接口相加，每 1 秒可请求 20 次；多个接口请求时，需注意/batch-kline 接口需间隔 1 秒；所有接口相加，1 分钟最大请求 1200 次(1 秒 20 次)；每天总共最大可请求 1728000 次，超过则第二天凌晨恢复使用 |

- 为什么数据最多只有 1000 条 k 线
  - 也是 API 的限制
